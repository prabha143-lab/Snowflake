Query 1: Employees earning more than their managers

SELECT E.EMPNO, E.ENAME, E.SAL AS EMP_SAL, M.ENAME AS MANAGER_NAME, M.SAL AS MGR_SAL
FROM EMP E
JOIN EMP M ON E.MGR = M.EMPNO
WHERE E.SAL > M.SAL;


Query 2: Employees earning less than their managers

EMPNO	ENAME	EMP_SAL	MANAGER_NAME	MGR_SAL
7788	SCOTT	3000.00	JONES	2975.00
7902	FORD	3000.00	JONES	2975.00

SELECT E.EMPNO, E.ENAME, E.SAL AS EMP_SAL, M.ENAME AS MANAGER_NAME, M.SAL AS MGR_SAL
FROM EMP E
JOIN EMP M ON E.MGR = M.EMPNO
WHERE E.SAL < M.SAL;

EMPNO	ENAME	EMP_SAL	MANAGER_NAME	MGR_SAL
7698	BLAKE	2850.00	KING	5000.00
7782	CLARK	2450.00	KING	5000.00
7566	JONES	2975.00	KING	5000.00
7499	ALLEN	1600.00	BLAKE	2850.00
7521	WARD	1250.00	BLAKE	2850.00
7654	MARTIN	1250.00	BLAKE	2850.00
7844	TURNER	1500.00	BLAKE	2850.00
7900	JAMES	950.00	BLAKE	2850.00
7934	MILLER	1300.00	CLARK	2450.00
7876	ADAMS	1100.00	SCOTT	3000.00
7369	SMITH	800.00	FORD	3000.00


SELECT E.EMPNO, E.ENAME, E.SAL AS EMP_SAL,
       M.ENAME AS MANAGER_NAME, M.SAL AS MGR_SAL,
       CASE
           WHEN E.SAL > M.SAL THEN 'EARNING MORE'
           WHEN E.SAL < M.SAL THEN 'EARNING LESS'
           ELSE 'EARNING SAME'
       END AS SALARY_COMPARISON
FROM EMP E
JOIN EMP M ON E.MGR = M.EMPNO
ORDER BY SALARY_COMPARISON DESC;


WITH EMP_MGR_COMPARISON AS (
    SELECT E.EMPNO, E.ENAME, E.SAL AS EMP_SAL,
           M.ENAME AS MANAGER_NAME, M.SAL AS MGR_SAL,
           CASE
               WHEN E.SAL > M.SAL THEN 'EARNING MORE'
               WHEN E.SAL < M.SAL THEN 'EARNING LESS'
               ELSE 'EARNING SAME'
           END AS SALARY_COMPARISON
    FROM EMP E
    JOIN EMP M ON E.MGR = M.EMPNO
)
SELECT *
FROM EMP_MGR_COMPARISON
ORDER BY SALARY_COMPARISON DESC;


EMPNO	ENAME	EMP_SAL	MANAGER_NAME	MGR_SAL	SALARY_COMPARISON
7788	SCOTT	3000.00	JONES	2975.00	EARNING MORE
7902	FORD	3000.00	JONES	2975.00	EARNING MORE

7698	BLAKE	2850.00	KING	5000.00	EARNING LESS
7782	CLARK	2450.00	KING	5000.00	EARNING LESS
7566	JONES	2975.00	KING	5000.00	EARNING LESS
7499	ALLEN	1600.00	BLAKE	2850.00	EARNING LESS
7521	WARD	1250.00	BLAKE	2850.00	EARNING LESS
7654	MARTIN	1250.00	BLAKE	2850.00	EARNING LESS
7844	TURNER	1500.00	BLAKE	2850.00	EARNING LESS
7900	JAMES	950.00	BLAKE	2850.00	EARNING LESS
7934	MILLER	1300.00	CLARK	2450.00	EARNING LESS
7876	ADAMS	1100.00	SCOTT	3000.00	EARNING LESS
7369	SMITH	800.00	FORD	3000.00	EARNING LESS




SELECT *FROM EMP;

INSERT INTO EMP VALUES (
 7940, 'RAJ', 'ANALYST', 7566,
 TO_DATE('01-01-1988','dd-mm-yyyy'),
 2975, NULL, 20
);


INSERT INTO EMP VALUES (
 7941, 'KIRAN', 'SALESMAN', 7698,
 TO_DATE('01-02-1988','dd-mm-yyyy'),
 2850, 500, 30
);


INSERT INTO EMP VALUES (
 7942, 'SURESH', 'CONSUL', NULL,
 TO_DATE('01-03-1988','dd-mm-yyyy'),
 4000, NULL, 40
);


INSERT INTO EMP VALUES (
 7943, 'MEENA', 'LEAD', NULL,
 TO_DATE('01-04-1988','dd-mm-yyyy'),
 5000, NULL, 10
);

WITH EMP_MGR_COMPARISON AS (
    SELECT E.EMPNO, E.ENAME, E.SAL AS EMP_SAL,
           M.ENAME AS MANAGER_NAME, M.SAL AS MGR_SAL,
           CASE
               WHEN E.SAL > M.SAL THEN 'EARNING MORE'
               WHEN E.SAL < M.SAL THEN 'EARNING LESS'
               WHEN E.SAL = M.SAL THEN 'EARNING SAME'
               ELSE 'NO COMPARISON'
           END AS SALARY_COMPARISON
    FROM EMP E
    JOIN EMP M ON E.MGR = M.EMPNO
)
SELECT *
FROM EMP_MGR_COMPARISON
ORDER BY SALARY_COMPARISON DESC;

EMPNO	ENAME	EMP_SAL	MANAGER_NAME	MGR_SAL	SALARY_COMPARISON
7940	RAJ	2975.00	JONES	2975.00	EARNING SAME
7941	KIRAN	2850.00	BLAKE	2850.00	EARNING SAME

7788	SCOTT	3000.00	JONES	2975.00	EARNING MORE
7902	FORD	3000.00	JONES	2975.00	EARNING MORE

7698	BLAKE	2850.00	KING	5000.00	EARNING LESS
7782	CLARK	2450.00	KING	5000.00	EARNING LESS
7566	JONES	2975.00	KING	5000.00	EARNING LESS
7369	SMITH	800.00	FORD	3000.00	EARNING LESS
7499	ALLEN	1600.00	BLAKE	2850.00	EARNING LESS
7521	WARD	1250.00	BLAKE	2850.00	EARNING LESS
7654	MARTIN	1250.00	BLAKE	2850.00	EARNING LESS
7844	TURNER	1500.00	BLAKE	2850.00	EARNING LESS
7876	ADAMS	1100.00	SCOTT	3000.00	EARNING LESS
7900	JAMES	950.00	BLAKE	2850.00	EARNING LESS
7934	MILLER	1300.00	CLARK	2450.00	EARNING LESS


WITH EMP_MGR_COMPARISON AS (
    SELECT E.EMPNO, E.ENAME, E.SAL AS EMP_SAL,
           M.ENAME AS MANAGER_NAME, M.SAL AS MGR_SAL,
           CASE
               WHEN M.SAL IS NULL THEN 'NO COMPARISON'
               WHEN E.SAL > M.SAL THEN 'EARNING MORE'
               WHEN E.SAL < M.SAL THEN 'EARNING LESS'
               WHEN E.SAL = M.SAL THEN 'EARNING SAME'
           END AS SALARY_COMPARISON
    FROM EMP E
    LEFT JOIN EMP M ON E.MGR = M.EMPNO
)
SELECT *
FROM EMP_MGR_COMPARISON
ORDER BY SALARY_COMPARISON DESC;

EMPNO	ENAME	EMP_SAL	MANAGER_NAME	MGR_SAL	SALARY_COMPARISON
7943	MEENA	5000.00			NO COMPARISON
7942	SURESH	4000.00			NO COMPARISON
7839	KING	5000.00			NO COMPARISON

7940	RAJ	2975.00	JONES	2975.00	EARNING SAME
7941	KIRAN	2850.00	BLAKE	2850.00	EARNING SAME

7902	FORD	3000.00	JONES	2975.00	EARNING MORE
7788	SCOTT	3000.00	JONES	2975.00	EARNING MORE

7934	MILLER	1300.00	CLARK	2450.00	EARNING LESS
7369	SMITH	800.00	FORD	3000.00	EARNING LESS
7876	ADAMS	1100.00	SCOTT	3000.00	EARNING LESS
7698	BLAKE	2850.00	KING	5000.00	EARNING LESS
7900	JAMES	950.00	BLAKE	2850.00	EARNING LESS
7844	TURNER	1500.00	BLAKE	2850.00	EARNING LESS
7654	MARTIN	1250.00	BLAKE	2850.00	EARNING LESS
7521	WARD	1250.00	BLAKE	2850.00	EARNING LESS
7499	ALLEN	1600.00	BLAKE	2850.00	EARNING LESS
7566	JONES	2975.00	KING	5000.00	EARNING LESS
7782	CLARK	2450.00	KING	5000.00	EARNING LESS