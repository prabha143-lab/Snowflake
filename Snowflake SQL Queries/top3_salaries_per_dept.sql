Top 3 Salaried Employees per Department


SELECT *FROM EMP;

SELECT *FROM(
SELECT EMPNO,ENAME,JOB,SAL,DEPTNO,
DENSE_RANK() OVER(PARTITION BY DEPTNO ORDER BY SAL DESC) RANK
FROM EMP)E
WHERE E.RANK<=3;

SELECT EMPNO,ENAME,JOB,SAL,DEPTNO,
DENSE_RANK() OVER(PARTITION BY DEPTNO ORDER BY SAL DESC) DRANK
FROM EMP
QUALIFY DRANK<=3

SELECT EMPNO,ENAME,JOB,SAL,DEPTNO
FROM EMP
QUALIFY DENSE_RANK() OVER(PARTITION BY DEPTNO ORDER BY SAL DESC)<=3

WITH DENSE_RANK AS(
SELECT EMPNO,ENAME,JOB,SAL,DEPTNO,
DENSE_RANK() OVER(PARTITION BY DEPTNO ORDER BY SAL DESC) DRANK
FROM EMP)
SELECT *FROM DENSE_RANK WHERE DRANK<=3

*****************OUTPUT***********************

EMPNO	ENAME	JOB	SAL	DEPTNO
7839	KING	PRESIDENT	5000.00	10
7782	CLARK	MANAGER	2450.00	10
7934	MILLER	CLERK	1300.00	10
7788	SCOTT	ANALYST	3000.00	20
7902	FORD	ANALYST	3000.00	20
7566	JONES	MANAGER	2975.00	20
7876	ADAMS	CLERK	1100.00	20
7698	BLAKE	MANAGER	2850.00	30
7499	ALLEN	SALESMAN	1600.00	30
7844	TURNER	SALESMAN	1500.00	30

